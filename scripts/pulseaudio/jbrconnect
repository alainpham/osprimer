#!/bin/bash

# Replace this with your controller's Bluetooth MAC address
DEVICE_MAC="6C:FB:ED:22:1A:86"

echo "[+] Resetting connection to device ($DEVICE_MAC)..."
echo "[*] Put in pairing mode.."
read -p "Press Enter once it's blinking rapidly..."

# Create command list for persistent session
{
    echo "remove $DEVICE_MAC"
    echo "scan on"
    sleep 5

    # Wait for the device to show up
    for i in {1..20}; do
        echo "devices"
        sleep 1
        if bluetoothctl devices | grep -q "$DEVICE_MAC"; then
            break
        fi
    done

    echo "scan off"
    echo "pair $DEVICE_MAC"
    sleep 2
    echo "trust $DEVICE_MAC"
    sleep 2
    echo "connect $DEVICE_MAC"
    sleep 5
} | bluetoothctl

echo "[âœ“] Re-pairing complete."